<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard partners | Client Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Ionicons -->
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
    <link rel="stylesheet" href="./src/theme-intra.css">
    <link rel="stylesheet" href="./src/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="app-container full-width-layout">
        <!-- Main Header -->
        <header class="main-header">
            <div class="header-left">
                <div class="client-branding">
                    <img id="client-logo" src="" alt="Client Logo" class="client-logo-img hidden">
                    <div class="welcome-area">
                        <span class="welcome-label">Bienvenido,</span>
                        <h2 class="welcome-name" id="welcome-name">Administrador</h2>
                    </div>
                </div>
            </div>

            <div class="header-right">
                <div class="intra-branding">
                    <img src="src/assets/intra-logo.png" alt="Intra" class="intra-logo-img">
                    <span class="partner-tag">Partner Portal</span>
                </div>
                <button onclick="logout()" class="logout-btn" title="Cerrar sesión">
                    <ion-icon name="log-out-outline"></ion-icon>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <div class="ticker-section">
                <div class="live-label">
                    <div class="live-dot"></div>
                    <span>Última actualización: Ahora mismo</span>
                </div>
                <h1 class="section-headline">
                    Dashboard <ion-icon name="globe-outline" class="globe-icon"></ion-icon>
                </h1>
            </div>

            <!-- Dashboard Grid -->
            <div class="dashboard-grid">

                <!-- Cards Row -->
                <div class="cards-grid">
                    <!-- Card 1: Leads Calificados -->
                    <div class="card-quantix card-orange">
                        <div class="card-accent-line orange"></div>
                        <div class="card-header">
                            <div class="card-title-wrapper">
                                <div class="icon-box"
                                    style="background: rgba(245, 158, 11, 0.1); border-color: rgba(245, 158, 11, 0.3); color: #F59E0B;">
                                    <ion-icon name="ribbon"></ion-icon>
                                </div>
                                <div class="label-group">
                                    <span class="label-sub">CALIDAD</span>
                                    <span class="label-main">Oportunidades calificadas</span>
                                </div>
                            </div>
                            <button class="more-btn"><ion-icon name="ellipsis-vertical"></ion-icon></button>
                        </div>

                        <div class="value-big" id="card-1-value">0</div>
                        <div class="pill-change pill-green">
                            <ion-icon name="arrow-up"></ion-icon> High Quality
                        </div>

                        <div class="card-chart-container">
                            <canvas id="chart-1"></canvas>
                        </div>
                    </div>

                    <!-- Card 2: Tasa de Conversión -->
                    <div class="card-quantix card-purple">
                        <div class="card-accent-line purple"></div>
                        <div class="card-header">
                            <div class="card-title-wrapper">
                                <div class="icon-box"
                                    style="background: rgba(117, 81, 255, 0.1); border-color: rgba(117, 81, 255, 0.3); color: #7551FF;">
                                    <ion-icon name="swap-vertical"></ion-icon>
                                </div>
                                <div class="label-group">
                                    <span class="label-sub">CALIFICADOS / TOTAL</span>
                                    <span class="label-main">Tasa de Conversión</span>
                                </div>
                            </div>
                            <button class="more-btn"><ion-icon name="ellipsis-vertical"></ion-icon></button>
                        </div>

                        <div class="value-big" id="card-2-value">0.0</div>
                        <div class="pill-change pill-green"
                            style="background: rgba(117, 81, 255, 0.15); color: #7551FF;">
                            Ratio Actual
                        </div>

                        <div class="card-chart-container">
                            <canvas id="chart-2"></canvas>
                        </div>
                    </div>

                    <!-- Card 3: Ventas -->
                    <div class="card-quantix card-cyan">
                        <div class="card-accent-line cyan"></div>
                        <div class="card-header">
                            <div class="card-title-wrapper">
                                <div class="icon-box"
                                    style="background: rgba(1, 241, 227, 0.1); border-color: rgba(1, 241, 227, 0.3); color: #01F1E3;">
                                    <ion-icon name="cash"></ion-icon>
                                </div>
                                <div class="label-group">
                                    <span class="label-sub">INGRESOS TOTALES</span>
                                    <span class="label-main">Ventas</span>
                                </div>
                            </div>
                            <button class="more-btn"><ion-icon name="ellipsis-vertical"></ion-icon></button>
                        </div>

                        <div class="value-big" id="card-3-value">$0</div>

                        <div class="card-chart-container">
                            <canvas id="chart-3"></canvas>
                        </div>
                    </div>

                    <!-- Card 4: ROI -->
                    <div class="card-quantix card-pink">
                        <div class="card-accent-line pink"></div>
                        <div class="card-header">
                            <div class="card-title-wrapper">
                                <div class="icon-box"
                                    style="background: rgba(255, 0, 229, 0.1); border-color: rgba(255, 0, 229, 0.3); color: #FF00E5;">
                                    <ion-icon name="rocket"></ion-icon>
                                </div>
                                <div class="label-group">
                                    <span class="label-sub">VENTAS / INVERSIÓN</span>
                                    <span class="label-main">ROI</span>
                                </div>
                            </div>
                            <button class="more-btn"><ion-icon name="ellipsis-vertical"></ion-icon></button>
                        </div>

                        <div class="value-big" id="card-4-value">0.0x</div>

                        <div class="card-chart-container">
                            <canvas id="chart-4"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Sketch Layout Implementation -->
                <!-- Layout V2: Split Row + Bottom Cards -->

                <!-- Middle Row: Chart & Table (50/50) -->
                <div class="split-row-grid">
                    <!-- Main Big Chart -->
                    <div class="card-quantix big-chart-card">
                        <div class="card-header" style="margin-bottom: 20px;">
                            <div>
                                <span class="label-sub">TENDENCIA HISTÓRICA</span>
                                <h3 class="section-headline" style="font-size: 1.5rem; margin: 0;">Comportamiento de
                                    Leads</h3>
                            </div>
                            <div class="table-tabs">
                                <button class="tab-btn active">7D</button>
                                <button class="tab-btn">1M</button>
                                <button class="tab-btn">3M</button>
                            </div>
                        </div>
                        <div style="flex: 1; position: relative; width: 100%;">
                            <canvas id="main-chart"></canvas>
                        </div>
                    </div>

                    <!-- Table Card -->
                    <div class="table-card" style="display: flex; flex-direction: column;">
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
                            <h3 style="margin: 0; font-size: 1.1rem; color: var(--text-secondary);">Oportunidades
                                calificadas
                            </h3>
                            <button id="view-all-btn" class="header-icon-btn" title="Ver info completa">
                                <ion-icon name="open-outline"></ion-icon>
                            </button>
                        </div>
                        <div class="table-wrapper" style="border:none; padding:0; background:none;">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Nombre</th>
                                        <th>Fecha</th>
                                        <th>Estado</th>
                                    </tr>
                                </thead>
                                <tbody id="leads-table-body">
                                    <!-- JS Injection -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Bottom Row: Remaining Cards -->
                <div class="bottom-cards-row">
                    <!-- Card 5: Total Leads -->
                    <div class="card-quantix card-orange">
                        <div class="card-accent-line orange"></div>
                        <div class="card-header">
                            <div class="card-title-wrapper">
                                <div class="icon-box"
                                    style="background: rgba(245, 158, 11, 0.1); border-color: rgba(245, 158, 11, 0.3); color: #F59E0B;">
                                    <ion-icon name="people"></ion-icon>
                                </div>
                                <div class="label-group">
                                    <span class="label-sub">METRICA 1</span>
                                    <span class="label-main">Total de Leads</span>
                                </div>
                            </div>
                        </div>
                        <div class="value-big" id="card-5-value">0</div>
                        <div class="pill-change pill-green">Generados</div>
                        <div class="card-chart-container"><canvas id="chart-5"></canvas></div>
                    </div>

                    <!-- Card 6: Inversión -->
                    <div class="card-quantix card-pink">
                        <div class="card-accent-line pink"></div>
                        <div class="card-header">
                            <div class="card-title-wrapper">
                                <div class="icon-box"
                                    style="background: rgba(255, 0, 229, 0.1); border-color: rgba(255, 0, 229, 0.3); color: #FF00E5;">
                                    <ion-icon name="wallet"></ion-icon>
                                </div>
                                <div class="label-group">
                                    <span class="label-sub">METRICA 4</span>
                                    <span class="label-main">Inversión</span>
                                </div>
                            </div>
                        </div>
                        <div class="value-big" id="card-6-value">$0</div>
                        <div class="pill-change pill-red">Presupuesto</div>
                        <div class="card-chart-container"><canvas id="chart-6"></canvas></div>
                    </div>

                    <!-- Card 7: CPL -->
                    <div class="card-quantix card-cyan">
                        <div class="card-accent-line cyan"></div>
                        <div class="card-header">
                            <div class="card-title-wrapper">
                                <div class="icon-box"
                                    style="background: rgba(1, 241, 227, 0.1); border-color: rgba(1, 241, 227, 0.3); color: #01F1E3;">
                                    <ion-icon name="pricetag"></ion-icon>
                                </div>
                                <div class="label-group">
                                    <span class="label-sub">METRICA 5</span>
                                    <span class="label-main">Costo x Lead</span>
                                </div>
                            </div>
                        </div>
                        <div class="value-big" id="card-7-value">$0.00</div>
                        <div class="pill-change pill-green">Eficiencia</div>
                        <div class="card-chart-container"><canvas id="chart-7"></canvas></div>
                    </div>
                </div>

                <!-- UTM Campaigns Row -->
                <div class="split-row-grid" style="margin-top: 2rem;">
                    <div class="card-quantix big-chart-card">
                        <div class="card-header" style="margin-bottom: 20px;">
                            <div>
                                <span class="label-sub">RENDIMIENTO POR CAMPAÑA</span>
                                <h3 class="section-headline" style="font-size: 1.5rem; margin: 0;">Leads Calificados por
                                    UTM</h3>
                            </div>
                        </div>
                        <div style="flex: 1; position: relative; width: 100%;">
                            <canvas id="utm-chart"></canvas>
                        </div>
                    </div>
                    <div class="card-quantix table-card" style="min-height: auto;">
                        <div class="card-header">
                            <div>
                                <span class="label-sub">TOP MEDIOS</span>
                                <h3 class="section-headline" style="font-size: 1.2rem; margin: 0;">Fuentes de Tráfico
                                </h3>
                            </div>
                        </div>
                        <div id="utm-list" style="margin-top: 1rem;">
                            <!-- JS Injection -->
                        </div>
                    </div>
                </div>

                <!-- Modal Structure -->
                <div id="leads-modal" class="modal-overlay hidden">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>Detalle Completo de Leads</h3>
                            <button class="close-modal">&times;</button>
                        </div>
                        <div class="modal-body">
                            <table class="modal-table">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Nombre</th>
                                        <th>Fecha</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="modal-table-body">
                                    <!-- JS Injection -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
        </main>

        <!-- Right Panel (Comentado por solicitud del usuario) -->
        <!-- <aside class="right-panel">
            <div class="exchange-flow">
                <div class="exchange-nav">
                    <div class="nav-pill active">Invertir</div>
                    <div class="nav-pill">Vender</div>
                    <div class="nav-pill">Canjear</div>
                </div>

                <h3 style="margin-bottom: 20px; font-weight: 500;">Simulador</h3>

                <div class="input-field-box">
                    <span class="label-small">Inversión (Gasto)</span>
                    <div class="input-flex">
                        <input type="text" class="big-input" value="$0" id="panel-invest" readonly>
                        <div class="currency-tag">
                            <ion-icon name="card-outline"></ion-icon> MXN
                        </div>
                    </div>
                </div>

                <div class="divider-arrow">
                    <ion-icon name="arrow-down-circle-outline"></ion-icon>
                </div>

                <div class="input-field-box">
                    <span class="label-small">Retorno (Ventas)</span>
                    <div class="input-flex">
                        <input type="text" class="big-input" value="$0" id="panel-sales" readonly>
                        <div class="currency-tag">
                            <ion-icon name="trending-up-outline"></ion-icon> MXN
                        </div>
                    </div>
                </div>

                <div
                    style="margin-top: 20px; display: flex; justify-content: space-between; font-size: 0.9rem; color: var(--text-secondary);">
                    <span>Multiplicador ROI</span>
                    <span style="color: white; font-weight: 700;" id="roi-txt">0.00x</span>
                </div>
                <div
                    style="margin-top: 10px; display: flex; justify-content: space-between; font-size: 0.9rem; color: var(--text-secondary);">
                    <span>Costo por Lead</span>
                    <span style="color: white; font-weight: 700;" id="cpl-txt">$0.00</span>
                </div>

                <button class="execute-btn">Generar Reporte</button>
            </div>
        </aside>
    </div>

    <!-- Scripts -->
        <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
        <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
        <script src="src/config.js"></script>
        <script src="src/auth.js"></script>
        <script src="src/dashboard.js"></script>
        <footer style="text-align: center; padding: 20px; color: var(--text-dim); font-size: 0.8rem; opacity: 0.6;">
            &copy; 2026 Dashboard partners. Todos los derechos reservados.
        </footer>
</body>

</html>